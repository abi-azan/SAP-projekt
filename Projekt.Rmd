---
title: "Oscar Projekt"
author: "SAPunanje mačora"
date: "2025-11-02"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r data setup}
library(dplyr)
library(readr)
library(stringr)
library(hflights)
library(tidyr)
library(lubridate)
library(ggplot2)
library(tidyverse)
oscars_dataset <- read_delim("oscars_dataset.csv", delim = ";", escape_double = FALSE, trim_ws = TRUE)
```

## Including Plots

You can also embed plots, for example:

```{r summary, echo=FALSE}
summary(oscars_dataset)
```

```{r pressure, echo=FALSE}
#Jesu li medu pobjednicima neki žanrovi češči? 

library(dplyr)

wins_by_genre <- oscars_dataset %>%
  filter(Award == "Winner") %>%
  count(`Main.Genre`, name = "Wins")

genre_count <- oscars_dataset %>%
  count(`Main.Genre`, name = "count")

barplot(wins_by_genre$Wins, xlab = "Genre", ylab = "Wins", main ="Wins by Genre",names.arg = wins_by_genre$`Main.Genre`,col = "light blue")
barplot(genre_count$count, xlab = "Genre", ylab = "count", main ="Genre Count",names.arg = genre_count$`Main Genre`,width = 20)

prvo_pitanje <- chisq.test(wins_by_genre$Wins)
print(prvo_pitanje)
```


```{r genre_duration, echo=FALSE}
#Jesu li neki žanrovi u prosjeku dulji od ostalih?
library(dplyr)

duration_by_genre <- oscars_dataset %>%
  group_by(`Main.Genre`) %>%
  summarise(
    Avg_Duration = mean(`Movie.Time`, na.rm = TRUE),
    Movie_Count = n()
  ) %>%
  arrange(desc(Avg_Duration))

print(duration_by_genre)

par(mar=c(10, 5, 4, 2))
boxplot(oscars_dataset$`Movie.Time` ~ oscars_dataset$`Main.Genre`,
        main = "Trajanje filmova po žanrovima",
        ylab = "Trajanje (min)",
        col = "light blue",
        las = 2,
        cex.axis = 0.8)

```





```{r imdb_winners_vs_others, echo=FALSE}
#Imaju li pobjednici veći IMDB rating od onih koji nisu pobijedili?
library(dplyr)


imdb_stats <- oscars_dataset %>%
  group_by(Award) %>%
  summarise(
    Prosjek_IMDb = mean(`IMDB.Rating`, na.rm = TRUE),
    Medijan_IMDb = median(`IMDB.Rating`, na.rm = TRUE),
    Broj_filmova = n()
  )

print(imdb_stats)

boxplot(oscars_dataset$`IMDB.Rating` ~ oscars_dataset$Award,
        main = "Usporedba IMDb ocjena: Pobjednici vs. Ostali",
        ylab = "IMDb Ocjena",
        xlab = "Status nagrade",
        col = c("lightgray", "gold"),
        names = c("Nominee", "Winner")) 

test_rezultat <- t.test(`IMDB.Rating` ~ Award, data = oscars_dataset)
print(test_rezultat)
```

```{r}
#Jesu li među pobjednicima neki producenti češči?
library(dplyr)
library(tidyr)


winners_producer <- oscars_dataset %>%
  filter(Award=="Winner") %>%
  separate_rows(`Film.Studio.Producer.s.`,sep= ",") %>%
  count(`Film.Studio.Producer.s.`, sort=TRUE)

barplot(winners_producer$n, xlab = "Producer", ylab = "n", main ="Wins by producer",names.arg = winners_producer$`Film.Studio.Producer.s.`,col = "light blue")

cetvrto_pitanje <- chisq.test(winners_producer$n)
print(cetvrto_pitanje)
```

# Kako su filmovi ocijenjeni s obzirom na njihovu starost?

```{r}
mean.imdb.rating <- mean(oscars_dataset2$imdb_rating)
mean.tomato.rating <- oscars_dataset2$tomato_rating %>% na.omit() %>% mean()
mean.audience.rating <- oscars_dataset2$audience_rating %>%  na.omit() %>% mean()
mean.year <- mean(oscars_dataset2$y_release)
imdb_ocjena_starost <- select(oscars_dataset2,y_release,imdb_rating)
```

```{r}
fit.imdb = lm(imdb_rating~y_release,data=imdb_ocjena_starost)
plot(imdb_ocjena_starost$y_release,imdb_ocjena_starost$imdb_rating,main = "IMDb Rating -Release Year",
     xlab = "Year of Release",
     ylab = "IMDB Rating",
     pch = 19, 
     col = "blue")
#lines(imdb_ocjena_starost$y_release,fit.imdb$fitted.values,col='red')
abline(fit.imdb, col = "red", lwd = 2)
#raspodjela rezidiuala
hist(fit.imdb$residuals) 
#studentova standardizacija reziduala
hist(rstandard(fit.imdb))
#iscitavanje podataka uključujući prilagođeni R^2
summary(fit.imdb)
#korelacije
cor(oscars_dataset2$y_release,oscars_dataset2$imdb_rating)

fit.tomato = lm(tomato_rating~y_release,data=oscars_dataset2)
plot(oscars_dataset2$y_release,oscars_dataset2$tomato_rating,main = "Tomato Rating -Release Year",
     xlab = "Year of Release",
     ylab = "Tomatometer Rating",
     pch = 19, 
     col = "tomato")
abline(fit.tomato, col = "green", lwd = 2)
hist(fit.tomato$residuals) 
hist(rstandard(fit.tomato))
summary(fit.tomato)

fit.audience = lm(audience_rating~y_release,data=oscars_dataset2)
plot(oscars_dataset2$y_release,oscars_dataset2$audience_rating,main = "Audience Rating -Release Year",
     xlab = "Year of Release",
     ylab = "Audience Rating",
     pch = 19, 
     col = "black")
abline(fit.audience, col = "red", lwd = 2)     
hist(fit.audience$residuals) 
hist(rstandard(fit.audience))
summary(fit.audience)
```

Očitujemo malu vrijednost R^2 čime dalje potvrđujuemo tvrdnju da starost filma nema utjecaj na ocjenu.
Za imdb je R^2 


```{r}



ggplot(imdb_ocjena_starost, aes(x = y_release, y = imdb_rating)) +
  geom_point(alpha = 0.5) +  # alpha makes points semi-transparent to see density
  geom_smooth(method = "lm", color = "blue", se = TRUE) + # "lm" = linear model
  labs(title = "Relationship Between Movie Age and IMDb Rating",
       x = "Release Year",
       y = "IMDb Rating") +
  theme_minimal()
ggplot(oscars_dataset2, aes(x = y_release, y = tomato_rating)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", color = "tomato", se = TRUE) + 
  labs(title = "Relationship Between Movie Age and Tomatometer Rating",
       x = "Release Year",
       y = "Tomato Rating") +
  theme_minimal()
ggplot(oscars_dataset2, aes(x = y_release, y = audience_rating)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", color = "green", se = TRUE) + 
  labs(title = "Relationship Between Movie Age and Audience Rating",
       x = "Release Year",
       y = "Audience Rating") +
  theme_minimal()
```

Moguče je na prvi pogled zaključiti kako godina izdanja ne utječe mnogo na ocjenu filma. Mali pozitivan nagib je upečaćen no ne smatramo ga toliko signifikantnim. Najveći nagib je u IMDB grafu.

```{r}
# test normalnosti reziuala p < 0.05
shapiro.test(fit.imdb$residuals) 
shapiro.test(fit.tomato$residuals) 
shapiro.test(fit.audience$residuals)
# p vrijednost je manje od o.o5 za sve a možemo zaključiti normalnost

cor.test(oscars_dataset2$y_release, oscars_dataset2$imdb_rating,method = "pearson")
cor.test(oscars_dataset2$y_release, oscars_dataset2$tomato_rating,method = "pearson")
cor.test(oscars_dataset2$y_release, oscars_dataset2$audience_rating,method = "pearson")
```

Nemožemo odbaciti hipotezu da su reziduali normalno distribuirani.
Pearson korelacijskim testom možemo vidjeti da su generalno slabo korelirani stime da imdb ima najveću korelaciju sa 0.33 što se može smatrati umjerenom korelacijom.
Kako su sve tri umjerene no pozitivne postoji mogučnost da noviji filmovi imaju bolje ocijene.



